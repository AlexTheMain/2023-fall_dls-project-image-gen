# Проект: Использование CycleGAN сетей для стилизации изображений

#### Ссылки:
- Связь с автором: https://t.me/xin_hai_tong
- Обученные модели тут: https://disk.yandex.ru/d/t0jmAJTELQqrRQ
- Телеграмм-бот тут: https://disk.yandex.ru/d/i3Lbn4P7VLeZNw

## Введение
Работа представляет собой финальный проект первого семестра Deep Learning School (осень 2023), а именно, создание CycleGAN сети глубокого обучения для решения image2image задачи. Работа сосредоточена на стилизации изображений, чтобы они соответствовали визуальному стилю, заимствованному из конкретных видеороликов, таких как мультфильмы, фильмы или стримы видеоигр.

Была разработана модель CycleGAN, которая позволяет нам переносить стили из видео в изображения. В проекте представлена архитектура, позволяющая выбирать тип генератора (ResNet и UNet), а также алгоритм формирования датасета, использующий извлечение кадров из видеороликов. Наша модель решает задачу стилизации исходного изображения в целевой стиль.

## Архитектура модели
### Генераторы:
- Стандартный генератор (ResNet-based): Основан на архитектуре ResNet.
- Дополнительный генератор (UNet-based): Использует архитектуру UNet.
#### ResNet Генератор:
- Пользователь может выбрать тип Residual блока при создании:
- InstanceNorm 2D (по умолчанию).
- BatchNorm2D.
### Дискриминатор:
- Реализован в соответствии с оригинальной статьей, используя архитектуру PatchGAN.
### Создание датасетов
- Для формирования необходимых наборов изображений из видеофайлов разработан скрипт, который позволяет создавать датасеты, необходимые для обучения сети.

## Использованные данные
- Серии мультфильма о Человеке-пауке (1994 год):
    Изображения из этих серий использовались для обучения сети и являлись целевым стилем.
- Monet2Image датасет (https://www.kaggle.com/datasets/balraj98/monet2photo):
    Использовались изображения реального мира из датасета оригинальной статьи.

## Задача
Наша нейросеть решает задачу перевода реальных изображений в стиль мультфильма о Человеке-пауке.

## Особенности работы
Метод создания датасетов из видео является важным дополнением к работе. Сам датасет созданный на основе мультфильма я не выкладываю, поскольку не знаю как там обстоят дела с авторскими правами. При желании можно воспользоваться кодом и создать его себе самостоятельно.

Для проверки результатов работы создан Telegram бот. Инструкции по запуску доступны в папке "TG_BOT". Для проверки бота необходим BOT_TOKEN, который можно получить в Telegram у бота BotFather. Обязательным условием является наличие на компьютере Docker, так как для простоты развертывания бот разворачивается и работает в контейнере.

В работе я использовал ChatGPT для расстановки комментариев в коде, а так же для написания функций построения графиков и отрисовки изображений. Остальной код писал самостоятельно. 

## Выводы по работе
### Что получилось хорошо:
- Создать работающую модель глубокого обучения с возможностью выбора архитектуры генератора.
- Решить задачу с поиском и созданием датасетов.
- Реализовать телеграм-бота для демонстрации результатов работы.

### Что получилось плохо:
- Слабые возможности ПК не позволили качествено обучить модель.
- Для ускорения процесса обучнения был выбран малнький датасет (770 изображенийиз мультфильма и 1540 изображений реального мира из датасета Monet https://www.kaggle.com/datasets/balraj98/monet2photo).
- Не хватило возможностей добавить в обучение моделей использование scheduler'ов.
- Модель хорошо работает только с изображениями, которые стилистически похожи на обучающую выборку. Другие изображения она стилизует не совсем качественно

### Что хотелось бы сделать лучше:
- Дообучить модель на более крупном датасете.
- Подобрать более точные параметры коэффициентов потерь, скорости обучения, количества эпох и др.
- Доработать оптимизацию кода и качество его оформления.